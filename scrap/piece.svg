<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   version="1.1"
   viewBox="0 0 2000 2000">
	<defs>
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="RedRect"
			style="fill:#f00;fill-opacity:1;stroke:#800;stroke-width:4;" />
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="GreenRect"
			style="fill:#080;fill-opacity:1;stroke:#040;stroke-width:4;" />
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="BlueRect"
			style="fill:#00f;fill-opacity:1;stroke:#008;stroke-width:4;" />
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="YellowRect"
			style="fill:#ff0;fill-opacity:1;stroke:#880;stroke-width:4;" />
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="CyanRect"
			style="fill:#088;fill-opacity:1;stroke:#044;stroke-width:4;" />
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="MagentaRect"
			style="fill:#808;fill-opacity:1;stroke:#404;stroke-width:4;" />
		<rect 
			width="64"
			height="64"
			rx="8"
			ry="8"
			x="-32"
			y="-32"
			id="GrayRect"
			style="fill:#555;fill-opacity:1;stroke:#2a2a2a;stroke-width:4;" />
		

		<rect
			width="64"
			height="1080"
			x="-32"
			y="0"
			id="Target"
			style="fill:url(#TargetGradient);fill-opacity:1;stroke:none" />
	</defs>
	
	<g id="aaa" transform="translate(-250,250)">
		<rect
			width="270"
			height="270"
			rx="8"
			ry="8"
			x="-135"
			y="-135"
			style="fill:transparent;stroke:#2a2a2a;stroke-width:4;" />
		
	</g>
	<g id="bbb" transform="translate(250,250)">
				<rect
			width="270"
			height="782"
			rx="8"
			ry="8"
			x="-39"
			y="-39"
			style="fill:transparent;stroke:#2a2a2a;stroke-width:4;" />
				<path d="m -32,224 768,0" style="stroke:#2a2a2a;stroke-width:4;"/>

	</g>
	
	<script type="text/javascript" xlink:href="Piece.class.js"/>
	<script type="text/javascript"><![CDATA[
		var g = document.getElementById('aaa');
		var p = new Piece(0);
		var a = document.getElementById('bbb');
		p.playArea = new function(){
			this.put = function(piece){
				a.appendChild(p.node);
		piece.area = this;
			}
			this.width = 4;
			this.height = 20;
			this.node = a;
		this.grid = Array(this.width);
		for (var i = 0; i < this.width;i++){
			this.grid[i] = Array(this.height);
		}
		};
		g.appendChild(p.node);
		var fr = 1/60;
		var turned;
		window.addEventListener('blur',function(){pause = true;});
		window.addEventListener('focus',function(){pause = false;last = Date.now();});
		var pause = false;
		var last = Date.now();
		var fixed= false;
		var prevGridY = -10;
		//p.log();
		setInterval(function(){	
			
			if (pause || fixed){return};
			var cur = Date.now();
			var interval = (cur-last)/1000;
			last = cur;
			p.update(interval);
			if (p.inUse && prevGridY != p.gridY){
		prevGridY = p.gridY;
				//p.rotateCw();console.log( p.gridX ,p.gridY);
		
		p.log();
			}
		
		
			if (p.gridY > 7){
		fixed = true;
 p.fix();
		console.log(a.innerHTML);
		}
		},fr*1000);
		p.moveQueue();
	]]></script>
</svg>
